<!DOCTYPE html>
<html lang="en">
<head>
    <!--
* Author : Ech0
* Email  : ech0.extreme@foxmail.com
* Time   : 04/22/2018 12:55 AM
*-->
    <meta charset="UTF-8">
    <title>L-Store</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!--lib-->
    <script src="../lib/jquery/jquery.js"></script>
    <link rel="stylesheet" href="../lib/bootstrap/bootstrap.css">
    <script src="../lib/bootstrap/popper.js"></script>
    <script src="../lib/bootstrap/bootstrap.js"></script>
    <!--sweetalert-->
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://cdn.bootcss.com/store.js/1.3.20/store.js"></script>
    <script src="https://cdn.bootcss.com/axios/0.18.0/axios.js"></script>
    <script src="../js/constant.js"></script>
    <script src="../js/common.js"></script>
    <!--distpicker-->
    <script src="../lib/distpicker/distpicker.common.js"></script>
    <script src="../lib/distpicker/distpicker.esm.js"></script>
    <script src="../lib/distpicker/distpicker.js"></script>
    <!--awesome-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css"
          integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
    <!--file-input-->
    <link rel="stylesheet" href="../lib/fileinput/fileinput.css">
    <link rel="stylesheet" href="../lib/fileinput/theme.css">
    <script src="../lib/fileinput/piexif.js"></script>
    <script src="../lib/fileinput/fileinput.js"></script>
    <script src="../lib/fileinput/zh.js"></script>
    <script src="../lib/fileinput/theme.js"></script>
    <!--functions-->
    <script src="../js/cart.js"></script>
    <script src="../js/address.js"></script>
    <script src="../js/product.js"></script>
    <!--todo modify-->
    <link rel="stylesheet" href="../css/custom.css">
</head>
<body>
<div class="container">

    <div id="add-address-modal" class="modal">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">添加地址</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body text-left">
                    <form class="needs-validation was-validated">
                        <div class="mb-2">
                            <label for="add-address-name">收件人：</label>
                            <input id="add-address-name" type="text" class="form-control w-50 d-inline-block  mr-2"
                                   required>
                            <div class="invalid-feedback d-inline-block w-25">
                                收件人不能为空 ！
                            </div>
                        </div>
                        <div class="mb-2">
                            <label for="add-address-phone">手机号：</label>
                            <input id="add-address-phone" type="number" class="form-control w-50 d-inline-block  mr-2"
                                   required>
                            <div class="invalid-feedback d-inline-block w-25">
                                手机号不能为空 ！
                            </div>
                        </div>
                        <div class="mb-2">
                            <label for="add-address-dist-selector">请选择地址：</label>
                            <div id="add-address-dist-selector" data-toggle="distpicker" class="d-inline-block  ">
                                <select id="add-address-province-selector" data-province="省"
                                        class="custom-select d-inline-block w-25"></select>
                                <select id="add-address-city-selector" data-city="市"
                                        class="custom-select d-inline-block w-25"></select>
                                <select id="add-address-district-selector" data-district="区"
                                        class="custom-select d-inline-block w-25"></select>
                            </div>
                        </div>
                        <div class="mb-2">
                            <label for="add-address-detail">街道信息：</label>
                            <input id="add-address-detail" type="text" class="form-control w-100   mr-2" required>
                            <div class="invalid-feedback  ">
                                街道信息不能为空 ！
                            </div>
                        </div>
                    </form>


                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="addAddress()">添加</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">放弃</button>
                </div>
            </div>
        </div>
    </div>
    <!--upload-img-modal-->
    <div class="modal fade" id="uploadImgModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">上传图片</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="file-loading">
                        <input id="fileInputBtn" name="image-file" multiple type="file">
                    </div>
                    <div id="kartik-file-errors">上传失败，请重试！</div>
                </div>
            </div>
        </div>
    </div>
    <!--顶部导航-->
    <div class="navbar navbar-expand-lg fixed-top navbar-dark bg-primary ">
        <div class="container">
            <a href="index.html" class="navbar-brand">L-store</a>
            <!--菜单按钮-->
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive"
                    aria-controls="" navbarResponsive aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <!--菜单-->
            <div class="collapse navbar-collapse text-center" id="navbarResponsive">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#">帮助</a>
                    </li>
                    <!--分类下拉框-->
                    <li class="nav-item dropdown ">
                        <div class="nav-link dropdown-toggle btn btn-primary" data-toggle="dropdown"><span
                                id="searchOption" class="pl-2">所有分类</span> <span class="caret"></span></div>
                        <div class="dropdown-menu ">
                            <!--fixed category -->
                            <div class="search-option dropdown-item">小说</div>
                            <div class="search-option dropdown-item">文学</div>
                            <div class="search-option dropdown-item">艺术</div>
                            <div class="search-option dropdown-item">卡通</div>
                            <div class="search-option dropdown-item">教育</div>
                            <div class="search-option dropdown-item">历史</div>
                            <div class="search-option dropdown-item">科技</div>
                            <hr>
                            <div class="search-option dropdown-item">所有分类</div>
                        </div>
                    </li>
                    <li class="nav-item ml-3 text-center">
                        <!--搜索框-->
                        <form class="form-inline mt-2 mt-md-0 ">
                            <input id="search-keyword" class="form-control mr-sm-2" type="text" placeholder="">
                        </form>
                    </li>
                    <li class="nav-item ml-3 text-center">
                        <div id="search-btn" class="btn btn-secondary  my-2 my-sm-0">搜索</div>
                    </li>
                </ul>
                <div id="login-links" class="text-center">
                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="./login.html#1" target="_top">登录</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="./login.html#2" target="_top">注册</a>
                        </li>
                    </ul>
                </div>
                <!--已经登录-->
                <div id="personal-links" class="d-none text-center">
                    <div class="nav navbar-nav mr-auto ">
                        <div class="nav-item mr-3">
                            <div class="btn-group" role="group" aria-label="Basic example">
                                <button type="button" class="btn btn-primary"
                                        onclick="window.location.href='./personal-center.html?target-panel=cart-info'">
                                    购物车
                                </button>
                                <button type="button" class="btn btn-primary"
                                        onclick="window.location.href='./personal-center.html?target-panel=personal-info'">
                                    个人中心
                                </button>
                                <div class="btn-group" role="group">
                                    <button id="btnGroupDrop2" type="button" class="btn btn-success dropdown-toggle"
                                            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></button>
                                    <div class="dropdown-menu" aria-labelledby="btnGroupDrop2">
                                        <a class="dropdown-item" href="#">我的订单</a>
                                        <a class="dropdown-item" href="#">商品收藏</a>
                                        <a class="dropdown-item" href="#">店铺收藏</a>
                                        <a class="dropdown-item"
                                           href="./personal-center.html?target-panel=personal-info">个人信息</a>
                                        <a class="dropdown-item" href="./personal-center.html/target-panel=addr-manage">地址管理</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="nav-item">
                            <div class="nav-link btn" onclick="logout()">退出</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <!--侧边导航栏-->
        <div class="col-sm-12 col-md-3 pt-2   text-center ">
            <div class="card mb-3 ">
                <h3 id="ranking-list" class="card-header ranking-title pb-1 pt-1">
                    <img class="icon mb-1" src="../img/common/personal-center.png">
                    我的Lan-Store
                </h3>
                <ul class="list-group list-group-flush text-omit ">
                    <!--seller-->
                    <div class="seller-module d-none">
                        <li data-target="#seller-options" data-toggle="collapse"
                            class="list-group-item list-group-item-light text-left "><b>• &nbsp;</b> 店铺管理
                        </li>
                        <div id="seller-options" class="collapse show">
                            <a href="#" id="store-info"
                               class="panel-link list-group-item list-group-item-light border-0"
                               data-target-panel="store-info-panel"> 店铺信息 </a>
                            <a href="#" id="product-manage" data-target-panel="product-manage-panel"
                               class=" panel-link list-group-item list-group-item-light border-0"> 商品管理 </a>
                            <a href="#" id="add-product"
                               class=" panel-link list-group-item list-group-item-light border-0"
                               data-target-panel="add-product-panel"> 添加商品 </a>

                            <a href="#" id="order-manage"
                               class="panel-link list-group-item list-group-item-light border-0"> 订单管理 </a>
                        </div>
                    </div>
                    <li data-target="#personal-options" data-toggle="collapse"
                        class="list-group-item list-group-item-light text-left "><b>• &nbsp;</b> 个人中心
                    </li>
                    <div id="personal-options" class=" show">
                        <a id="personal-info" href="#" data-target-panel="personal-info-panel"
                           class="list-group-item list-group-item-light border-0 panel-link "> 个人信息 </a>
                        <a id="cart-info" href="#" data-target-panel="cart-info-panel"
                           class="list-group-item list-group-item-light border-0 panel-link"> 我的购物车 </a>
                        <a id="addr-manage" href="#" class="panel-link list-group-item list-group-item-light border-0"
                            data-target-panel="addr-manage-panel">
                            收货地址 </a>
                        <a id="apply-store" href="#" data-target-panel="apply-store-panel"
                           class="buyer-module list-group-item list-group-item-light border-0 panel-link d-none">我要开店</a>
                    </div>
                    <li data-target="#trade-options" data-toggle="collapse"
                        class="list-group-item list-group-item-light text-left "><b>• &nbsp;</b> 我的交易
                    </li>
                    <div id="trade-options" class=" show ">
                        <a href="#" id="my-order"
                           class=" panel-link list-group-item list-group-item-light border-0"> 我的订单 </a>
                        <a href="#" id="my-bill"
                           class="panel-link list-group-item list-group-item-light border-0"> 我的账单 </a>
                    </div>
                    <li data-target="#favorite-options" data-toggle="collapse"
                        class="list-group-item list-group-item-light text-left"><b>• &nbsp;</b> 我的收藏
                    </li>
                    <div id="favorite-options" class=" show">
                        <a href="#" id="product-favorite"
                           class="panel-link list-group-item list-group-item-light border-0"> 商品收藏 </a>
                        <a href="#" id="store-favorite"
                           class="panel-link list-group-item list-group-item-light border-0"> 店铺收藏 </a>
                    </div>
                    <li data-target="#gift-options" data-toggle="collapse"
                        class="list-group-item list-group-item-light text-left"><b>• &nbsp;</b> 我的钱包
                    </li>
                    <div id="gift-options" class="collapse">
                        <a href="#" class="list-group-item list-group-item-light border-0"> 我的礼券 </a>
                        <a href="#" class="list-group-item list-group-item-light border-0"> 我的账单 </a>
                        <a href="#" class="list-group-item list-group-item-light border-0"> 我的余额 </a>
                    </div>
                    <li data-target="#after-sell-options" data-toggle="collapse"
                        class="list-group-item list-group-item-light text-left"><b>• &nbsp;</b> 售后服务
                    </li>
                    <div class="collapse" id="after-sell-options">
                        <a href="#" class="list-group-item list-group-item-light border-0"> 申请/查询退货 </a>
                        <a href="#" class="list-group-item list-group-item-light border-0"> 补开发票 </a>
                    </div>
                </ul>
            </div>
        </div>
        <div class="col-sm-12 col-md-9">
            <!--个人信息-->
            <div id="personal-info-panel" class="panel collapse w-100 border  rounded mt-2">
                <!--base-info-->
                <div class="row border  rounded">
                    <!--头像-->
                    <div class="col-4 col-lg-2 pl-2 mt-2 pr-1 border  rounded">
                        <img id="personal-info-head-img"
                             class="head-img-l img-thumbnail rounded-circle  border border-success"
                             src="http://p7f7rr200.bkt.clouddn.com/b6463e9a-e8e2-44a6-909b-332887e5d995" alt="">
                    </div>
                    <!--简要信息-->
                    <div class="col-6 col-lg-8 mt-2   rounded">
                        <!--username-->
                        <div id="personal-info-username" class=" badge badge-pill badge-primary"> Echo009</div>
                        <div></div>
                        <!--phone-->
                        <div id="personal-info-phone" class="h6 d-inline-block pr-2 mt-2">17673207341</div>
                        <!--sex-->
                        <div id="personal-info-sex" class=" badge badge-pill badge-secondary "> ♀</div>
                        <div></div>
                        <!--email-->
                        <div id="personal-info-email" class="text-muted text-info mt-1"></div>
                        <!--addr-->
                        <div id="personal-info-addr" class="mt-1">
                            湖南 <span class="text-muted  "> 省</span> 湘潭<span class="text-muted  "> 市</span>
                        </div>
                    </div>
                    <!--修改按钮-->
                    <div class="col-2 col-lg-2 mt-2 pl-4    rounded text-right  ">
                        <img src="../img/common/modify.png" class="icon" data-toggle="tooltip" data-placement="top"
                             title="" data-original-title="修改个人信息">
                        </img>
                    </div>
                </div>
                <!--order-->
                <div class="row border  rounded mt-1">
                    <div class="w-100 col ">
                        <!-- Nav tabs -->
                        <ul class="nav nav-tabs nav-justified" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" data-toggle="tab" href="#all">全部订单</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-toggle="tab" href="#wait-for-pay">待付款</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-toggle="tab" href="#wait-for-sign">待收货</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" data-toggle="tab" href="#wait-for-comment">待评价</a>
                            </li>
                        </ul>
                        <!-- Tab panes -->
                        <div class="tab-content">
                            <div id="all" class="container tab-pane active"><br>
                                <h3 class="w-100 "> (｡í _ ì｡)   <small class="pl-4">这里什么都没有 ~ </small></h3>
                                <p></p>
                            </div>
                            <div id="wait-for-pay" class="container tab-pane fade"><br>
                                <h3 class="w-100 "> ( 。ớ ₃ờ)ھ   <small class="pl-4">这里也是什么都没有 ~ </small></h3>
                                <p></p>
                            </div>
                            <div id="wait-for-sign" class="container tab-pane fade"><br>
                                <h3 class="w-100 "> ( •̥́ ˍ •̀ू )  <small class="pl-4">这里还是什么都没有 ~ </small></h3>
                                <p></p>
                            </div>
                            <div id="wait-for-comment" class="container tab-pane fade"><br>
                                <h3 class="w-100 "> ˚‧º·(˚ ˃̣̣̥᷄⌓˂̣̣̥᷅ )‧º·˚  <small class="pl-4">这里真的什么都没有 ~ </small></h3>
                                <p></p>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <!--申请成为卖家-->
            <div id="apply-store-panel" class="panel collapse w-100 border  rounded mt-2">
                <div lass="row pt-1 pl-3 pr-3 pb-3">
                    <div class="col w-100 order-md-1 ">
                        <h5 class="mb-3">完善店铺信息</h5>
                        <hr class="mb-4">
                        <form class="needs-validation was-validated" novalidate="">
                            <div class="row">
                                <div class="col-sm-12 col-md-6 mb-3">
                                    <label for="storeName">店铺名称</label>
                                    <input type="text" class="form-control" id="storeName" name="storeName"
                                           placeholder="" value=""
                                           required="">
                                    <div class="invalid-feedback">
                                        店铺名称不能为空 ！
                                    </div>
                                </div>
                            </div>
                            <div class="row ">
                                <!--头像-->
                                <div class="col-sm-12 col-md-8 mb-3   ">
                                    <input id="storeCoverImg" type="hidden">
                                    <div class="row align-items-end">
                                        <div class="col-4 mr-0">
                                            <img id="preview-store-cover-img" style="max-width: 10rem"
                                                 class="d-inline-block head-img-l mr-3 rounded-circle border border-light"
                                                 src="http://p7f7rr200.bkt.clouddn.com/f660f8df-2adc-4310-ba02-cb302bbbc8ca"
                                                 alt="">
                                        </div>
                                        <div class="col-4">
                                            <div id="uploadImgBtn"
                                                 class="d-inline-block btn btn-info border-success border"
                                                 data-toggle="modal"
                                                 data-target="#uploadImgModal"> 更改店铺图标
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-12 col-md-6 mb-3">
                                    <label for="email">联系邮箱 <span class="text-muted">(选填)</span></label>
                                    <input type="email" class="form-control" id="email" placeholder="xxx@example.com">
                                    <div class="invalid-feedback">
                                        请输入有效的邮箱地址 ！
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-6 mb-3">
                                    <label for="email">联系电话 *</label>
                                    <input type="tel" class="form-control" id="registerPhone" required>
                                    <div class="invalid-feedback">
                                        请输入有效的联系电话 ！
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-3 mb-3">
                                    <label for="realName">申请人姓名 *</label>
                                    <input type="text" class="form-control" id="realName" placeholder="" value=""
                                           required="">
                                    <div class="invalid-feedback">
                                        申请人姓名不能为空 ！
                                    </div>
                                </div>

                                <div class="col-sm-12 col-md-9 mb-3">
                                    <label for="idNumber">身份证号码 *</label>
                                    <input type="text" class="form-control" id="idNumber" placeholder="" value=""
                                           required="">
                                    <div class="invalid-feedback">
                                        申请人身份证号码不能为空 ！
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-9 mb-3">
                                    <label for="bankNum">银行卡号 *</label>
                                    <input type="number" class="form-control" id="bankNum" required>
                                    <div class="invalid-feedback">
                                        请输入有效银行卡号 ！
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-10 mb-3">
                                    <label for="dist-selector">地址 *</label>
                                    <div id="dist-selector" data-toggle="distpicker">
                                        <select id="province-selector" data-province="省"
                                                class="custom-select d-inline-block w-25"></select>
                                        <select id="city-selector" data-city="市"
                                                class="custom-select d-inline-block w-25"></select>
                                        <select id="district-selector" data-district="区"
                                                class="custom-select d-inline-block w-25"></select>
                                    </div>
                                </div>
                            </div>
                            <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" id="user-protocol">
                                <label class="custom-control-label" for="user-protocol">我已阅读并同意lan-store用户使用协议</label>
                            </div>
                            <hr class="mb-4">
                            <div class="row">
                                <div class="col-9">
                                    <div class="btn btn-primary btn-block" onclick="applyStore()">提交申请</div>
                                </div>
                                <div class="col-3">
                                    <input type="reset" class="btn btn-danger btn-block" value="重置">
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!--店铺信息-->
            <div id="store-info-panel" class="panel collapse w-100 border  rounded mt-2">
                <div class="row pt-1 pl-3 pr-3 pb-3">
                    <div class="col w-100 order-md-1 ">
                        <div class="row">
                            <div class="col mt-2 pt-2">
                                <h5 class="mb-3 d-inline-block">我的店铺信息</h5>
                                <img src="../img/common/modify.png" class="icon d-inline-block float-right"
                                     data-toggle="tooltip" data-placement="top"
                                     data-original-title="修改店铺信息">
                                </img>
                            </div>
                        </div>
                        <hr class="mb-4">
                        <form>
                            <div class="row">
                                <div class="col-sm-12 col-md-6 mb-3">
                                    <label for="storeName">店铺名称</label>
                                    <input type="text" class="form-control" id="info-storeName" name="storeName"
                                           placeholder="" value="" disabled
                                           required="">
                                </div>
                            </div>

                            <div class="row ">
                                <!--头像-->
                                <div class="col-sm-12 col-md-8 mb-3   ">
                                    <input id="info-storeCoverImg" type="hidden"
                                           value="http://p7f7rr200.bkt.clouddn.com/f660f8df-2adc-4310-ba02-cb302bbbc8ca">
                                    <div class="row align-items-end">
                                        <div class="col-4 mr-0">
                                            <img id="info-preview-store-cover-img"
                                                 class="d-inline-block head-img-l mr-3 rounded-circle border border-light"
                                                 src="http://p7f7rr200.bkt.clouddn.com/f660f8df-2adc-4310-ba02-cb302bbbc8ca"
                                                 alt="">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-12 col-md-6 mb-3">
                                    <label for="email">联系邮箱 <span class="text-muted"></span></label>
                                    <input type="email" class="form-control" id="info-email" disabled>

                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-6 mb-3">
                                    <label for="email">联系电话 </label>
                                    <input type="tel" class="form-control" id="info-registerPhone" disabled>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-6 mb-3">
                                    <label for="dist-selector">店铺地址 </label>
                                    <input type="text" class="form-control" id="info-addr" disabled>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-3 mb-3">
                                    <label for="realName">申请人姓名 </label>
                                    <input type="text" class="form-control" id="info-realName" disabled>
                                </div>

                                <div class="col-sm-12 col-md-9 mb-3">
                                    <label for="idNumber">身份证号码 </label>
                                    <input type="text" class="form-control" id="info-idNumber" disabled>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-9 mb-3">
                                    <label for="bankNum">银行卡号 </label>
                                    <input type="number" class="form-control" id="info-bankNum" disabled>
                                </div>
                            </div>

                            <hr class="mb-4">
                        </form>
                    </div>
                </div>
            </div>
            <!--添加商品-->
            <div id="add-product-panel" class="panel collapse w-100 border  rounded mt-2">
                <div class="row pt-1 pl-3 pr-3 pb-3">
                    <div class="col w-100 order-md-1 ">
                        <h5 class="mb-3">完善商品信息</h5>
                        <hr class="mb-4">
                        <form class="needs-validation was-validated" novalidate="">
                            <div class="row">
                                <div class="col-sm-12 col-md-6 mb-3">
                                    <label for="bookName">书籍名称 *</label>
                                    <input type="text" class="form-control" id="bookName" name="name" required>
                                    <div class="invalid-feedback">
                                        书籍名称不能为空 ！
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-4 mb-3">
                                    <label for="authorName">作者 *</label>
                                    <input type="text" class="form-control" id="authorName" required>
                                    <div class="invalid-feedback">
                                        请输入有效的作者姓名 ！
                                    </div>
                                </div>
                                <div class="col-sm-12 col-md-4 mb-3">
                                    <label for="category">书籍分类 *</label>
                                    <div class="form-group">
                                        <select class="form-control w-50" id="category" required>
                                            <option></option>
                                            <option>小说</option>
                                            <option>文学</option>
                                            <option>艺术</option>
                                            <option>卡通</option>
                                            <option>教育</option>
                                            <option>历史</option>
                                            <option>科技</option>
                                        </select>
                                        <div class="invalid-feedback">
                                            请选择书籍分类 ！
                                        </div>
                                    </div>

                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-10 mb-3">
                                    <label for="recommendation">推荐语 <span class="text-muted">(选填)</span></label>
                                    <input type="text" class="form-control" id="recommendation">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-8 mb-3">
                                    <label for="publisher">出版社名称 *</label>
                                    <input type="text" class="form-control" id="publisher" placeholder="" value=""
                                           required="">
                                    <div class="invalid-feedback">
                                        出版社名称不能为空 ！
                                    </div>
                                </div>
                                <div class="col-sm-12 col-md-4 mb-3">
                                    <label for="publishDate">出版日期 *</label>
                                    <input type="date" class="form-control " id="publishDate" placeholder="" value=""
                                           required="">
                                    <div class="invalid-feedback">
                                        出版日期不能为空 ！
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-5 col-md-4 mb-3">
                                    <label for="pricing">定价 *</label>
                                    <input type="text" class="form-control" id="pricing" required>
                                    <div class="invalid-feedback">
                                        请输入有效的书本定价 ！
                                    </div>
                                </div>
                                <div class="col-sm-5 col-md-4 mb-3">
                                    <label for="currentPrice">售价 *</label>
                                    <input type="text" class="form-control" id="currentPrice" required>
                                    <div class="invalid-feedback">
                                        请输入有效的书本售价 ！
                                    </div>
                                </div>
                                <div class="col-sm-5 col-md-4 mb-3">
                                    <label for="stock">库存 *</label>
                                    <input type="number" class="form-control" id="stock" required>
                                    <div class="invalid-feedback">
                                        请输入有效的库存量 ！
                                    </div>
                                </div>
                            </div>
                            <!--封面图-->
                            <hr>
                            <p class="pl-3"> 封面图 *</p>
                            <hr>
                            <div class="row align-items-end mt-3 mb-3 ">

                                <input type="hidden" id="coverImg">
                                <div class="col-sm-12 col-md-6 mr-0 ">
                                    <img id="preview-book-cover-img"
                                         class="d-inline-block small-cover-img mr-1  border border-light"
                                         src="http://p7f7rr200.bkt.clouddn.com/165e804d-507c-4d49-a6d3-410cec791ffc">
                                </div>
                                <div class="col-sm-12 col-md-4 mt-2">
                                    <div id="uploadBookCoverImgBtn"
                                         class="d-inline-block btn btn-info border-success border "
                                         data-toggle="modal"
                                         data-target="#uploadImgModal"> 上传封面图
                                    </div>
                                </div>
                            </div>
                            <hr>
                            <div class="row pl-3">
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" checked class="custom-control-input" id="product-protocol">
                                    <label class="custom-control-label" for="user-protocol">我已阅读并同意lan-商品协议</label>
                                </div>
                            </div>

                            <hr class="mb-4">
                            <div class="row">
                                <div class="col-9">
                                    <div class="btn btn-primary btn-block" onclick="addProduct()">添加</div>
                                </div>
                                <div class="col-3">
                                    <input type="reset" class="btn btn-danger btn-block" value="重置">
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!--补充商品详情-->
            <div id="add-product-detail-panel" class="panel collapse w-100 border  rounded mt-2">
                <input type="hidden" id="bookId">
                <input type="hidden" id="bookDetailId">
                <div class="row pt-1 pl-3 pr-3 pb-3">
                    <div class="col w-100 order-md-1 ">
                        <input type="hidden" id="action">
                        <h5 class="mb-3" id="product-detail-panel-title">添加商品详情信息</h5>
                        <hr class="mb-4">
                        <form class="needs-validation was-validated" novalidate="">
                            <div class="row">
                                <div class="col-sm-12 col-md-6 mb-3">
                                    <label for="bookName">书籍名称 *</label>
                                    <input type="text" class="form-control border-0 " id="bookDetail-bookName" disabled>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-2 mb-3">
                                    <label for="authorName">版本号 *</label>
                                    <input type="number" class="form-control" id="edition" required>
                                    <div class="invalid-feedback">
                                        请输入有效的版本号 ！
                                    </div>
                                </div>
                                <div class="col-sm-12 col-md-2 mb-3">
                                    <label for="authorName">总字数 </label>
                                    <input type="number" class="form-control" id="words" value="0">
                                </div>
                                <div class="col-sm-12 col-md-2 mb-3">
                                    <label for="authorName">总页数 </label>
                                    <input type="number" class="form-control" id="pages" value="0">
                                </div>
                                <div class="col-sm-12 col-md-4 mb-3">
                                    <label for="paperType">纸张类型 *</label>
                                    <div class="form-group">
                                        <select class="form-control w-50" id="paperType" required>
                                            <option>胶版纸</option>
                                            <option>牛皮纸</option>
                                            <option>白卡纸</option>
                                            <option>印刷纸</option>
                                        </select>
                                        <div class="invalid-feedback">
                                            请选择纸张类型！
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-4 mb-3">
                                    <label for="publishDate">印刷日期 *</label>
                                    <input type="date" class="form-control " id="printDate" placeholder="" value=""
                                           required="">
                                    <div class="invalid-feedback">
                                        印刷日期不能为空 ！
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-10 mb-3">
                                    <div class="form-group">
                                        <label for="authorIntro">作者简介 *</label>
                                        <textarea class="form-control" id="authorIntro" rows="2" required></textarea>
                                        <div class="invalid-feedback">
                                            作者简介不能为空 ！
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-12 col-md-10 mb-3">
                                    <div class="form-group">
                                        <label for="briefIntro">书籍简介 *</label>
                                        <textarea class="form-control" id="briefIntro" rows="3" required></textarea>
                                        <div class="invalid-feedback">
                                            书籍简介不能为空 ！
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-sm-12 col-md-10 mb-3">
                                    <div class="form-group">
                                        <label for="foreword">前言/序章 </label>
                                        <textarea class="form-control" id="foreword" rows="5"></textarea>
                                    </div>
                                </div>
                            </div>
                            <!--商品详情图-->
                            <div class="row">
                                <input type="hidden" id="images" value="">
                                <div class="col-12 mb-3">
                                    <div class="file-loading">
                                        <input id="detail-img-input" name="image-file" type="file" multiple
                                               accept="image">
                                    </div>
                                </div>
                            </div>
                            <div class="row pl-3">
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" checked class="custom-control-input"
                                           id="product-protocol-dump">
                                    <label class="custom-control-label" for="user-protocol">我已阅读并同意lan-商品协议</label>
                                </div>
                            </div>

                            <hr class="mb-4">
                            <div class="row">
                                <div class="col-9">
                                    <div class="btn btn-primary btn-block" id="detail-submit-btn"
                                         onclick="operateProductDetail()"></div>
                                </div>
                                <div class="col-3">
                                    <input type="reset" class="btn btn-danger btn-block" value="重置">
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!--商品管理-->
            <div id="product-manage-panel" class="panel collapse w-100 border  rounded mt-2"
                 style="overflow: auto;max-height: 80rem;overflow-x: hidden">
                <div class="row row pt-1 pl-3 pr-3 pb-3">
                    <div class="col w-100 order-md-1 ">
                        <h5 class="mb-3 text-left">商品管理</h5>
                        <hr>
                        <div id="product-container" style="cursor: pointer;">
                        </div>
                    </div>
                </div>
            </div>
            <!--购物车-->
            <div id="cart-info-panel" class="panel collapse  w-100 border  rounded mt-2  ">
                <h5 class="mb-3 text-left mt-3 ml-2"><i class="fas fa-shopping-cart"></i>我的购物车</h5>
                <hr>
                <div class="row pt-1 pl-3 pr-3 pb-3">
                    <div class="col w-100 " id="carts">
                    </div>
                </div>
                <div class="col text-center align-items-center w-100">
                    <div class="btn btn-primary  mt-3 w-75"><i class="fas fa-credit-card"></i> 购买</div>
                </div>
                <hr>
            </div>
            <!--地址管理-->
            <div id="addr-manage-panel" class="panel collapse w-100 border rounded mt-2  ">
                <div class="row pt-1 pl-3 pr-3 pb-3">
                    <div class="col w-100 ">
                        <h5 class="mb-3 text-left"><i class="fas fa-shopping-cart"></i>我的收货地址</h5>
                        <hr>
                        <div id="addr-container">
                        </div>
                        <hr>
                        <div id="add-address-btn" class="btn btn-block btn-primary" onclick="showAddressModal()">
                            <i class="fas fa-user-plus"></i> 添加地址
                        </div>
                    </div>
                </div>
                <hr>
            </div>

        </div>
    </div>
</div>
<footer class="text-muted text-center">
    Copyright © 2018 Lan-store Powered by <a href="http://lan.echo0.cn">lan.echo0.cn</a>
</footer>
</div>
</body>
<script>
    $(function () {


        // bind click event
        $(document).on("click", ".panel-link", function () {
            var $currentElement = $(this);
            console.log(this.id);
            //  current link is active ?
            if ($currentElement.hasClass("text-primary")) {
                return false;
            }
            updateAndShowPanel(this.id);
        });

        // fileinput
        $("#fileInputBtn").fileinput({
            theme: "explorer-fas",
            language: "zh",
            resizeImage: true,
            maxImageWidth: 300,
            maxImageHeight: 300,
            resizePreference: 'width',
            resizeIfSizeMoreThan: 512,
            showPreview: true,
            showUpload: true,
            uploadUrl: "http://localhost/book-store/image/upload",
            elErrorContainer: '#kartik-file-errors',
            allowedFileExtensions: ["jpg", "png", "gif"],
            maxFileCount: 1
        });
        $("#detail-img-input").fileinput({
            uploadUrl: "http://localhost/book-store/image/upload",
            language: "zh",
            allowedFileExtensions: ['jpg', 'png', 'gif'],
            overwriteInitial: true,
            initialPreviewAsData: true
        });
        $("#detail-img-input").on('fileuploaded', function (event, data, previewId, index) {
            response = data.response;
            var $imges = $("#images");
            var value = $imges.val();
            value += ";" + response.data;
            $imges.val(value);
            console.log(value);
        });
        $('#fileInputBtn').on('fileuploaded', function (event, data, previewId, index) {
            response = data.response;
            // data desc code
            // judge current panel
            if ($("#add-product").hasClass("text-primary")) {
                // set preview img
                $("#preview-book-cover-img").attr("src", response.data);
                // set hidden input value
                $("#coverImg").val(response.data);
            }
            else if ($("#apply-store").hasClass("text-primary")) {
                // set preview img
                $("#preview-store-cover-img").attr("src", response.data);
                // set hidden input value
                $("#storeCoverImg").val(response.data);
            }
            $("#uploadImgModal").modal('hide');
            console.log(response.data);
        });

        // 检查登录状态
        var currentUser = store.get(CURRENT_USER);
        try {
            if (currentUser.userName) {
                console.log("current user : " + currentUser.userName);
                $("#login-links").addClass("d-none");
                $("#personal-links").removeClass("d-none");
            } else {
                simpleWarningInfo("请登录！");
                setTimeout("window.location.href = \"./index.html\";", MIDDLE_DELAY);
            }
            if (currentUser.roleCode == SELLER) {
                // 显示卖家模块
                $(".seller-module").removeClass("d-none");
            } else {
                // 显示申请成为卖家相关菜单
                $(".buyer-module").removeClass("d-none");
            }
        } catch (e) {
            // jump to index
            simpleWarningInfo("请登录！");
            setTimeout("window.location.href = \"./index.html\";", MIDDLE_DELAY);
        }
        // init panel
        var targetPanelLinkId = getQueryVariable("target-panel");
        if (targetPanelLinkId != false) {
            updateAndShowPanel(targetPanelLinkId);
        } else {
            // 默认显示个人信息面板
            $("#personal-info-panel").show();
            updatePersonalInfoPanel();
        }

        //set default value
        $("#coverImg").val(DEFALUT_BOOK_COVER_IMG);
        $("#storeCoverImg").val(DEFALUT_STORE_COVER_IMG);
    });


    // 申请店铺
    function applyStore() {
        var storeName = $("#storeName").val();
        var storeCoverImg = $("#storeCoverImg").val();
        var email = $("#email").val();
        var registerPhone = $("#registerPhone").val();
        var realName = $("#realName").val();
        var idNumber = $("#idNumber").val();
        var bankNum = $("#bankNum").val();
        var addr = $("#province-selector").val() + '-' + $("#city-selector").val();
        const params = new URLSearchParams();
        params.append("storeName", storeName);
        params.append("storeCoverImg", storeCoverImg);
        params.append("email", email);
        params.append("registerPhone", registerPhone);
        params.append("realName", realName);
        params.append("idNumber", idNumber);
        params.append("bankNum", bankNum);
        params.append("addr", addr);
        instance.post("/store/create", params).then(function (response) {
            console.log(response.data.desc);
            if (response.data.code == 0) {
                updateUserInfo();
                simpleSuccessInfo("申请成功 ！");
                setTimeout(function () {
                    window.location.href = "./personal-center.html";
                }, MIDDLE_DELAY);
            } else {
                simpleErrorInfo(response.data.desc);
            }
        }).catch(function (error) {
            console.log(error);
        });
    };

    // 更新个人面板
    function updatePersonalInfoPanel() {
        var curentUserInfo = store.get(CURRENT_USER);
        $("#personal-info-head-img").text(curentUserInfo.headImg);
        $("#personal-info-username").text(curentUserInfo.userName);
        $("#personal-info-phone").text(curentUserInfo.phone);
        $("#personal-info-email").text(curentUserInfo.email);
    }

    function updateStoreInfoPanel() {
        instance.get("/store/info").then(function (response) {
            console.log(response.data.desc);
            var returnData = response.data.data;
            if (response.data.code == 0) {
                $("#info-storeName").val(returnData.storeName);
                $("#info-realName").val(returnData.realName);
                $("#info-idNumber").val(returnData.idNumber);
                $("#info-email").val(returnData.email);
                $("#info-registerPhone").val(returnData.registerPhone);
                $("#info-bankNum").val(returnData.bankNum);
                $("#info-addr").val(returnData.addr);
                $("#info-storeCoverImg").attr("src", returnData.storeCoverImg);
            } else {
                simpleErrorInfo(response.data.desc);
            }
        }).catch(function (error) {
            console.log(error);
        });
    }




    function updateCartInfoPanel() {
        $(".arrow").remove();
        $(".tooltip-inner").remove();
        $("#carts").html("");
        instance.get('/cart/all')
            .then(function (response) {
                console.log("update cartInfo ..." + response.data.data.userName);
                response.data.data.forEach(function (cartWrapperData) {
                    addCart(cartWrapperData);
                })
            })
            .catch(function (error) {
                console.log(error);
            });
    };

    // 更新面板信息
    function updateAndShowPanel(targetPanelLinkId) {
        if (targetPanelLinkId != null) {
//            store-info
            var $currentElement = $("#" + targetPanelLinkId);
            $(".panel-link").removeClass("text-primary");
            $currentElement.addClass("text-primary");

            var targetPanelSelector = "#" + $currentElement.attr("data-target-panel");
            console.log("target panel is " + targetPanelSelector);
            // hidden all panel
            $(".panel").slideUp(MICRO_DELAY);
            $(targetPanelSelector).slideDown(MIDDLE_DELAY);

            switch (targetPanelSelector) {
                case "#personal-info-panel" : {
                    updatePersonalInfoPanel();
                    break;
                }
                case "#store-info-panel" : {
                    updateStoreInfoPanel();
                    break;
                }
                case "#product-manage-panel" : {
                    updateProductManagePanel();
                    break;
                }
                case "#cart-info-panel" : {
                    updateCartInfoPanel();
                    break;
                }
                case "#addr-manage-panel" :{
                    updateAddrManagePanel();
                    break;
                }
            }
        }
    }

    /**
     * 切换面板不更新数据
     * @param panelName
     */
    function switchPanel(panelName) {
        $(".panel").slideUp(MICRO_DELAY);
        $(".panel-link").removeClass("text-primary");
        $("#" + panelName).slideDown(MIDDLE_DELAY);
    }

    /**
     * 更新商品管理面板
     */
    function updateProductManagePanel() {
        var books;
        instance.get('/book/all')
            .then(function (response) {
                books = response.data.data;
                console.log(" num of books  :" + books.length);
                if (books.length != 0) {
                    var $productContainer = $("#product-container");
                    $productContainer.html("");
                    books.forEach(function (currentValue) {
                        console.log(currentValue);
                        // generate dom
                        var productsString = " <div data-product-id='" + currentValue.id + "' class='row product'  >\n" +
                            "                        <div class='col-12'>\n" +
                            "                            <div class='card flex-md-row mb-4 box-shadow h-md-180'>\n" +
                            "                                <img class=' d-none d-md-block  small-cover-img img-thumbnail '\n" +
                            "                                     src='" + currentValue.coverImg + "' data-holder-rendered='true'>\n" +
                            "                                <div class='card-body align-items-start text-nowrap text-justify'>\n" +
                            "                                    <strong> " + currentValue.bookName + "</strong>\n" +
                            "                                    <div class='badge badge-info d-inline-block'>" + currentValue.category + "</div>\n" +
                            "                                    <hr>\n" +
                            "                                    <div class='h6 d-inline-block pr-2'>" + currentValue.authorName + "</div>\n" +
                            "                                    <span class='badge badge-primary ml-2'>" + currentValue.publishDate + "</span>\n" +
                            "                                    <div>\n" +
                            "                                        <price class='text-danger'>\n" +
                            "                                            ￥<h5 class='font-weight-bold d-inline-block pr-2 '>" + currentValue.currentPrice + "</h5>\n" +
                            "                                        </price>\n" +
                            "                                        <del>￥" + currentValue.pricing + "</del>\n" +
                            "                                        <h6 class='d-inline-block pl-2'>" + currentValue.publisher + "</h6>\n" +
                            "                                    </div>\n" +
                            "                                    <div>\n" +
                            "                                        <h6 class='h6 d-inline-block pr-2'> 已售: " + currentValue.sales + "</h6>\n" +
                            "                                        <h6 class='h6 d-inline-block pr-2'> 库存: " + currentValue.stock + "</h6>\n" +
                            "                                    </div>\n" +
                            "                                </div>\n" +
                            "                                <div class='card-footer flex-md-row align-middle btn-light'>\n" +
                            "                                    <img src='../img/common/modify.png' class='icon m-auto d-block align-middle'" +
                            "                                         data-toggle='tooltip' data-placement='top' data-product-id=''\n" +
                            "                                         data-original-title='修改商品信息'>\n" +
                            "                                    </img>\n" +
                            "                                </div>\n" +
                            "                            </div>\n" +
                            "                        </div>\n" +
                            "                    </div>";
                        var $book = $(productsString);
                        $book.appendTo($productContainer);

                    });
                }
            })
            .catch(function (error) {
                console.log(error);
            });


    }

</script>
</html>